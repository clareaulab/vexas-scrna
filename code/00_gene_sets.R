# Gene sets from Landau paper
GOBP_REGULATION_OF_MYELOID_LEUKOCYTE_DIFFERENTIATION <- c("CDK6","TRIB1","LRRC17","FSTL3","PIAS3","HAX1","CEBPB","TOB2","LILRB1","LILRB4","LILRB3","CCR1","OCSTAMP","TMEM178A","SLC9B2","PPARGC1B","CREB1","ZBTB46","CSF1","IL34","IL23R","CTNNB1","ERFE","ZFPM1","TMEM64","ZNF675","EVI2B","FBN1","FES","ACIN1","FOS","MTOR","FSHB","GATA2","FOXP1","HCLS1","HLA-DRB1","HOXA7","APCS","HSF1","IAPP","ID2","IFNG","IL4","IL5","IL12B","IL17A","INHA","INHBA","INPP5D","IRF7","LIF","EEIG1","LTF","LYN","MIR125B1","MIR145","MIR223","KITLG","MITF","MYC","NEDD9","NF1","NOTCH2","ROR2","TNFRSF11B","PLA2G3","IL20","LEF1","CLDN18","IL23A","PF4","PIK3R1","TREM2","POU4F1","POU4F2","TESC","FBXW7","PPP3CA","PRKCA","GPR137","CTNNBIP1","RPTOR","PTPN2","RARA","RB1","MIR486-1","BGLAP","CEACAM1","CCL3","SFRP1","ZFP36L1","TAL1","TCTA","TFE3","TGFB1","KLF10","TLR3","TLR4","GPR137B","TNF","TNFAIP6","C1QC","TRAF6","TYROBP","NDFIP1","GPR68","CAMK4","DCSTAMP","CASP8","PRXL2A","CUL4A","UBASH3B","TNFSF11","RUNX1","RIPK1","FADD","TNFRSF11A","CD4","GPR55","ADIPOQ","CD101","QKI","CARTPT","CD74","RASSF2","MAFB")
REACTOME_TRANSLATION <- c("RPS20","LARS2","SARS1","RPL26L1","MRPS10","MRPL43","SEC61A1","MRPS35","MRPS24","EIF4B","RPL18","KARS1","SEC61A2","TRAM1","IARS2","PABPC1","EIF2B3","RPL31","MRPS34","MRPL22","RPS5","EIF3I","MTIF2","MRPL28","RPL6","RPLP0","MRPS33","AARS1","MRPS18A","RPS18","VARS1","EIF3L","RPL3","EIF3D","EIF5","SRP54","EEF1A2","MRPS31","GSPT1","EARS2","MTFMT","EIF3J","EIF3E","EEF1D","SARS2","RPS16","MRPL4","RPS19","RPL18A","GARS1","EIF3B","AIMP2","MRPL32","EIF4H","SEC61B","EIF3A","RPL28","RPL19","MRPL27","RPL34","CARS1","RPS13","EIF2B1","MRPL51","MTRF1L","MRPL18","RPS12","MRPL2","HARS2","MRPS30","MRPS27","TARS1","RARS1","RPL24","MRPL3","SSR3","EIF4G1","SPCS1","EEF1B2","EIF2B4","RPS15","MRPL19","DARS1","FARSB","MRPL37","RPL22","WARS2","MRPS15","DARS2","RPS25","SPCS2","RPN2","EIF2B2","MRPS14","ETF1","RPL21","MTIF3","MRPS2","RPL5","TSFM","AARS2","RPS10","SSR1","EEF1E1","MRPS7","RPL23","MRPS26","EIF2S2","MRPS12","SPCS3","RPS4Y1","RPL36","MRPL34","EIF2S3","EIF3G","MRPS25","RPL27","PTCD3","MRPL35","SEC61G","ERAL1","DAP3","LARS1","EIF2S1","MRPS36","RPS15A","NARS1","YARS1","CARS2","MRPL44","MRPS9","MRPL47","EPRS1","MRPL50","RPL35","RPS6","VARS2","NARS2","MRPL15","RPLP1","RPS24","PPA2","YARS2","WARS1","SRP14","SEC11A","RPL3L","RPS2","RPS11","RPL13A","RPL11","RPS8","MRPL24","TARS2","MRPL9","SRP9","RPS27A","MRPS5","RPL32","SRPRB","EIF2B5","RPS3A","RPL37","FARS2","RARS2","RPL10","MRPS28","RPL7","EIF3H","MRRF","RPL7A","EIF3M","RPS3","MRPL49","FAU","EIF4E","SRP19","MRPL39","OXA1L","N6AMT1","RPL30","EEF1A1","EIF4A2","MRPL17","EIF5B","MRPL10","RPL8","EIF4A1","RPL26","RPL29","PARS2","MRPL55","MRPS18C","SSR2","RPL22L1","RPL9","RPN1","RPL39L","AIMP1","APEH","GFM2","RPS14","RPL10L","RPL36AL","RPL27A","SEC11C","MRPL16","MARS1","RPL13","EEF2","MRPL58","SRP68","RPSA","GFM1","MRPL1","HARS1","RPS9","MRPL36","RPS21","RPS7","QARS1","MRPL13","CHCHD1","MRPL52","RPL38","TRMT112","MRPL57","EIF1AX","RPL4","MRPL11","RPL15","SRP72","MRPS22","EIF3F","MRPL48","AURKAIP1","RPLP2","RPS27","TUFM","EIF3K","FARSA","GADD45GIP1","PPA1","SSR4","MRPL14","MRPS23","MRPS11","MRPL41","MRPS16","RPS17","RPL35A","SRPRA","MRPL54","EIF3C","RPS27L","MRPL30","MRPL40","RPS23","EIF4EBP1","RPL14","GSPT2","IARS1","MRPL21","RPS26","RPL37A","RPL12","MRPL42","RPS4X","RPL23A","RPL10A","RPL39","MRPS18B","MRPL38","VARS1","MRPS18B","MRPL53","MT-RNR2","MT-RNR1","RPS29","MRPL23","UBA52","","","RPS18","VARS2","MRPS18B","VARS1","MRPS18B","RPS18","VARS1","MRPS18B","RPL41","MRPS18B","VARS1","RPS18","MRPS18B","RPS28","RPS18","MRPS17","RPL36A","MRPL20","MRPL33","MRPS6","DDOST","MARS2","EEF1G","MRPL46","MRPL12","RPL17","MRPS21","EEF1D","RPS9","RPS9","RPS9","RPS9","RPS9","RPS9","RPS9","MRPL45","RPS9","CARS1","RPS17","RPS9","MRPS36","RPS25","RPL7A","RPS4Y2","EIF3K","MRPS12","SARS2","EEF1B2","MRPL23")
HALLMARK_INFLAMMATORY_RESPONSE <- c("ABCA1","ABI1","ACVR1B","ACVR2A","ADM","ADORA2B","ADRM1","AHR","APLNR","AQP9","ATP2A2","ATP2B1","ATP2C1","AXL","BDKRB1","BEST1","BST2","BTG2","C3AR1","C5AR1","CALCRL","CCL17","CCL2","CCL20","CCL22","CCL24","CCL5","CCL7","CCR7","CCRL2","CD14","CD40","CD48","CD55","CD69","CD70","CD82","CDKN1A","CHST2","CLEC5A","CMKLR1","CSF1","CSF3","CSF3R","CX3CL1","CXCL10","CXCL11","CXCL6","CXCL9","CXCR6","CYBB","DCBLD2","EBI3","EDN1","EIF2AK2","EMP3","ADGRE1","EREG","F3","FFAR2","FPR1","FZD5","GABBR1","GCH1","GNA15","GNAI3","GP1BA","GPC3","GPR132","GPR183","HAS2","HBEGF","HIF1A","HPN","HRH1","ICAM1","ICAM4","ICOSLG","IFITM1","IFNAR1","IFNGR2","IL10","IL10RA","IL12B","IL15","IL15RA","IL18","IL18R1","IL18RAP","IL1A","IL1B","IL1R1","IL2RB","IL4R","IL6","IL7R","CXCL8","INHBA","IRAK2","IRF1","IRF7","ITGA5","ITGB3","ITGB8","KCNA3","KCNJ2","KCNMB2","KIF1B","KLF6","LAMP3","LCK","LCP2","LDLR","LIF","LPAR1","LTA","LY6E","LYN","MARCO","MEFV","MEP1A","MET","MMP14","MSR1","MXD1","MYC","NAMPT","NDP","NFKB1","NFKBIA","NLRP3","NMI","NMUR1","NOD2","NPFFR2","OLR1","OPRK1","OSM","OSMR","P2RX4","P2RX7","P2RY2","PCDH7","PDE4B","PDPN","PIK3R5","PLAUR","PROK2","PSEN1","PTAFR","PTGER2","PTGER4","PTGIR","PTPRE","PVR","RAF1","RASGRP1","RELA","RGS1","RGS16","RHOG","RIPK2","RNF144B","ROS1","RTP4","SCARF1","SCN1B","SELE","SELL","SELENOS","SEMA4D","SERPINE1","SGMS2","SLAMF1","SLC11A2","SLC1A2","SLC28A2","SLC31A1","SLC31A2","SLC4A4","SLC7A1","SLC7A2","SPHK1","SRI","STAB1","TACR1","TACR3","TAPBP","TIMP1","TLR1","TLR2","TLR3","TNFAIP6","TNFRSF1B","TNFRSF9","TNFSF10","TNFSF15","TNFSF9","TPBG","VIP")
REACTOME_UNFOLDED_PROTEIN_RESPONSE_UPR <- c("NFYA","MBTPS2","EXTL3","DDX11","CUL7","HSPA5","HERPUD1","CREB3L3","PDIA5","NFYC","PPP2R5B","WIPI1","ASNS","ACADVL","MYDGF","EXOSC7","EXOSC5","DIS3","ADD1","KHSRP","DNAJB11","KDELR3","XBP1","ARFGAP1","DNAJC3","GSK3A","FKBP14","CREB3","EXOSC3","GOSR2","CCL2","WFS1","ZBTB17","ATF6","EXOSC8","SERP1","NFYB","EXOSC9","KLHDC3","SSR1","EIF2S2","ATF4","DNAJB9","EXOSC2","EIF2S3","EIF2S1","EDEM1","TLN1","PREB","SEC31A","PARN","MBTPS1","HDGF","CREB3L4","PDIA6","SRPRB","IGFBP1","HYOU1","CEBPG","CXXC1","TATDN2","CREB3L1","EXTL1","ATP6V0D1","SHC1","LMNA","SYVN1","EXTL2","ATF3","CREBRF","DCSTAMP","TPP1","HSP90B1","ATF6B","CXCL8","EXOSC1","EIF2AK3","CEBPB","DCP2","YIF1A","DDIT3","CTDSP2","ERN1","EXOSC4","CALR","CREB3L2","SRPRA","TSPYL2","GFPT1","DCTN1","ATF6B","EXOSC6","ATF6B","ATF6B","PLA2G4B","SULT1A3","PARN","HYOU1")
HALLMARK_APOPTOSIS <- c("ADD1","AIFM3","ANKH","ANXA1","APP","ATF3","AVPR1A","BAX","BCAP31","BCL10","BCL2L1","BCL2L10","BCL2L11","BCL2L2","BGN","BID","BIK","BIRC3","BMF","BMP2","BNIP3L","BRCA1","BTG2","BTG3","CASP1","CASP2","CASP3","CASP4","CASP6","CASP7","CASP8","CASP9","CAV1","CCNA1","CCND1","CCND2","CD14","CD2","CD38","CD44","CD69","CDC25B","CDK2","CDKN1A","CDKN1B","CFLAR","CLU","CREBBP","CTH","CTNNB1","CYLD","DAP","DAP3","DCN","DDIT3","DFFA","DIABLO","DNAJA1","DNAJC3","DNM1L","DPYD","EBP","EGR3","EMP1","ENO2","ERBB2","ERBB3","EREG","ETF1","F2","F2R","FAS","FASLG","FDXR","FEZ1","GADD45A","GADD45B","GCH1","GNA15","GPX1","GPX3","GPX4","GSN","GSR","GSTM1","GUCY2D","H1-0","HGF","HMGB2","HMOX1","HSPB1","IER3","IFITM3","IFNB1","IFNGR1","IGF2R","IGFBP6","IL18","IL1A","IL1B","IL6","IRF1","ISG20","JUN","KRT18","LEF1","LGALS3","LMNA","PLPPR4","LUM","MADD","MCL1","MGMT","MMP2","NEDD9","NEFH","PAK1","PDCD4","PDGFRB","PEA15","PLAT","PLCB2","PMAIP1","PPP2R5B","PPP3R1","PPT1","PRF1","PSEN1","PSEN2","PTK2","RARA","RELA","RETSAT","RHOB","RHOT2","RNASEL","ROCK1","SAT1","SATB1","SC5D","SLC20A1","SMAD7","SOD1","SOD2","SPTAN1","SQSTM1","TAP1","TGFB2","TGFBR3","TIMP1","TIMP2","TIMP3","TNF","TNFRSF12A","TNFSF10","TOP2A","TSPO","TXNIP","VDAC2","WEE1","XIAP")

l_h_landau <- list(
  GOBP_REGULATION_OF_MYELOID_LEUKOCYTE_DIFFERENTIATION,
  REACTOME_TRANSLATION,
  HALLMARK_INFLAMMATORY_RESPONSE,
  REACTOME_UNFOLDED_PROTEIN_RESPONSE_UPR,
  HALLMARK_APOPTOSIS
)
l_h_names <- c("GOBP_REGULATION_OF_MYELOID_LEUKOCYTE_DIFFERENTIATION", "REACTOME_TRANSLATION", "HALLMARK_INFLAMMATORY_RESPONSE", "REACTOME_UNFOLDED_PROTEIN_RESPONSE_UPR", "HALLMARK_APOPTOSIS")

vexas_degs <- fread("../data/vexas_deg_hscs.txt") %>%
  filter(p_val_adj < 0.01)
vexas_up <- (vexas_degs %>% filter(avg_log2FC > 2) %>% pull(Gene))
vexas_down <- (vexas_degs %>% filter(avg_log2FC < -2) %>% pull(Gene))

length(vexas_up)
length(vexas_down)

# separate human and mouse 
mouse_human_genes <- fread("../data/HOM_MouseHumanSequence.rpt",sep="\t") %>% data.frame()
mouse <- split.data.frame(mouse_human_genes,mouse_human_genes$Common.Organism.Name)[[2]]
human <- split.data.frame(mouse_human_genes,mouse_human_genes$Common.Organism.Name)[[1]]

# remove some columns
mouse <- mouse[,c(1,4)]
human <- human[,c(1,4)]

# merge the 2 dataset  (note that the human list is longer than the mouse one)
mh_data <- merge.data.frame(mouse,human,by = "DB.Class.Key",all.y = TRUE) 
h2m <- mh_data$Symbol.x; names(h2m) <- mh_data$Symbol.y

human_to_mouse_gs <- function(vec){
  vec_mm_raw <- unname(h2m[vec])
  vec_mm_raw[!is.na(vec_mm_raw)]
}

# Make mouse gene sets
l_m_landau <- list(
  human_to_mouse_gs(GOBP_REGULATION_OF_MYELOID_LEUKOCYTE_DIFFERENTIATION),
  human_to_mouse_gs(REACTOME_TRANSLATION),
  human_to_mouse_gs(HALLMARK_INFLAMMATORY_RESPONSE),
  human_to_mouse_gs(REACTOME_UNFOLDED_PROTEIN_RESPONSE_UPR),
  human_to_mouse_gs(HALLMARK_APOPTOSIS)
)

vexas_up_mouse <- human_to_mouse_gs(vexas_up)
vexas_down_mouse <- human_to_mouse_gs(vexas_down)

